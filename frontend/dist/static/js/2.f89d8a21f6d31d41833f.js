webpackJsonp([2,7,24],{"2uFj":function(t,e,a){"use strict";a.d(e,"a",function(){return o});var o={site:a("iGry").site}},"5eyz":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getInfo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return Object(o.a)({url:"/api/admin",method:"get",params:{page:e,pageSize:a,name:t.name,email:t.email}})},e.getCurrentPage=function(t){return Object(o.a)({url:"/api/admin",method:"get",params:{page:t}})},e.getInfoById=function(t){return Object(o.a)({url:"/api/admin/"+t,method:"get"})},e.resetAdminByPsw=function(t,e){return Object(o.a)({url:"/api/admin/"+t+"/reset",method:"post",data:{password:e}})},e.uploadAdminByImg=function(t){return Object(o.a)({url:"/api/admin/uploadAvatar",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})},e.updateInfo=function(t,e){return Object(o.a)({url:"/api/admin/"+t,method:"put",params:{name:e.name,role:e.role,avatar:e.avatar},headers:{"Content-Type":"application/x-www-form-urlencoded"}})},e.deleteInfoById=function(t){return Object(o.a)({url:"/api/admin/"+t,method:"delete"})},e.addInfo=function(t){return console.log(t),Object(o.a)({url:"/api/admin",method:"post",data:t})},e.uploadFile=function(t){return Object(o.a)({url:"/api/admin/upload",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})},e.Model=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";this.name=t,this.email=e,this.role=a,this.avatar=o,this.password=n,this.password_confirmation=i},e.SearchModel=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";this.name=t,this.email=e};var o=a("Vo7i")},U9IO:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={name:"UploadXls",props:{show:Boolean,templateFile:String,module:String},data:function(){return{}},computed:{uploadDialogFormVisible:function(){return this.show}},methods:{cancelUpload:function(){this.$emit("close-upload")},saveUpload:function(){this.$emit("close-upload")},downloadTemplate:function(){location.href=this.templateFile},submitUpload:function(){var t=this;this.$confirm("是否上传指定的内容","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(e){t.$refs.upload.submit()}).catch(function(){console.log("上传操作取消")})},beforeUpload:function beforeUpload(file){var _this2=this;if("application/vnd.ms-excel"!==file.type)return this.$message({type:"error",message:"文件格式不正确，无法上传"}),!1;var fd=new FormData;fd.append("file",file),__webpack_require__("2HpL")("./"+this.module).then(function(_ref){var uploadFile=_ref.uploadFile;return uploadFile(fd).then(function(res){_this2.$message({message:"文件信息上传成功",type:"success"});try{"function"==typeof eval(_this2.$parent.fetchData)&&_this2.$parent.fetchData()}catch(t){console.log("没有相关函数")}}),!0})}}}},"WXV/":function(t,e,a){var o=a("kSC+");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("97e56f9e",o,!0)},YC21:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("U9IO"),n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"文件导入",center:"",visible:t.uploadDialogFormVisible,"close-on-click-modal":!1},on:{close:function(e){t.cancelUpload()}}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(e){t.downloadTemplate()}}},[t._v("下载模板")])],1),t._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"123",accept:".xls","auto-upload":!1,"before-upload":t.beforeUpload}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选择文件")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("上传到服务器")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传xls文件")])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.saveUpload()}}},[t._v("确 定")]),t._v(" "),a("el-button",{on:{click:function(e){t.cancelUpload()}}},[t._v("取 消")])],1)],1)},staticRenderFns:[]};var i=function(t){a("jlWz")},l=a("VU/8")(o.a,n,!1,i,"data-v-b7438e30",null);e.default=l.exports},iGry:function(t,e){t.exports={site:"http://web.ynxpyz.cn"}},iYVw:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("pFYg"),n=a.n(o),i=(a("TIfe"),a("5eyz")),l=a("STSY"),r=a("2uFj"),s={components:{UploadXls:a("YC21").default},data:function(){return{searchForm:new i.SearchModel,form:new i.Model,imageUrl:"",tableData:[],resetDialogFormVisible:!1,editDialogFormVisible:!1,templateFile:r.a.site+"/xls/user.xls",resetId:"",uploadId:"",isNew:!1,isEdit:!1,isShowUpload:!1,form2:{psw:"",newpsw:""},roles:[],current_page:1,total:0,pageSize:10}},methods:{getModule:function(){return"admin"},find:function(){this.fetchData()},findReset:function(){this.searchForm=new i.SearchModel,this.fetchData()},add:function(){this.isNew=!0,this.form=new i.Model,this.editDialogFormVisible=!0},upload:function(){this.isShowUpload=!0},closeUpload:function(){this.isShowUpload=!1},uploadHandle:function(t){var e=this,a=new FormData;return a.append("file",t),Object(i.uploadFile)(a).then(function(t){e.$message({message:"文件信息上传成功",type:"success"}),e.fetchData()}),!0},download:function(){console.log("导出操作")},beforeUpload:function(t){var e=this,a=new FormData;return a.append("photo",t),Object(i.uploadAdminByImg)(a).then(function(t){var a=t.data.url;e.form.avatar=a,e.imageUrl=r.a.site+"/"+a}),!0},fetchData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.searchForm,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.current_page,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pageSize;Object(i.getInfo)(t,a,o).then(function(t){var a=t.data;e.tableData=a,e.total=t.meta.total}).catch(function(){})},edit:function(t){var e=this,a=t.id;this.uploadId=a,Object(i.getInfoById)(a).then(function(t){var a=t.data;e.form=a,a.avatar?e.imageUrl=r.a.site+"/"+a.avatar:e.imageUrl="",e.isEdit=!0,e.editDialogFormVisible=!0})},cancel:function(){this.isNew=!1,this.isEdit=!1,this.editDialogFormVisible=!1},save:function(){this.editDialogFormVisible=!1,this.isNew&&(this.isNew=!1,this.newData()),this.isEdit&&(this.isEdit=!1,this.updateData())},newData:function(){var t=this;Object(i.addInfo)(this.form).then(function(e){t.success("用户添加成功"),t.fetchData()}).catch(function(e){t.error(e.response.data)})},updateData:function(){var t=this;Object(i.updateInfo)(this.uploadId,this.form).then(function(e){if(200==e.status_code){var a=t.form.id,o=0;o=t.tableData.findIndex(function(t,e){return t.id==a}),t.tableData.splice(o,1,t.form),t.editDialogFormVisible=!1,t.success("用户信息修改成功")}}).catch(function(e){t.error(e.response.data)})},reset:function(t){this.form2={psw:"",newpsw:""},this.resetDialogFormVisible=!0,this.resetId=t.id},cancelPassword:function(){this.resetDialogFormVisible=!1},savePassword:function(){var t=this;if(this.form2.psw==this.form2.newpsw&&this.form2.psw){var e=this.form2.psw;Object(i.resetAdminByPsw)(this.resetId,e).then(function(e){200==e.status_code&&(t.success("恭喜你，重置密码成功"),t.resetDialogFormVisible=!1)})}else this.$message.error({message:"输入密码为空或两次输入密码不同，请重新输入！"}),this.resetDialogFormVisible=!1},del:function(t){var e=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.id,o=null;o=e.tableData.findIndex(function(t){return t.id==a}),Object(i.deleteInfoById)(a).then(function(t){200==t.status_code&&(e.success("删除成功!"),e.tableData.splice(o,1))}).catch(function(){})}).catch(function(){})},error:function(t){var e=this.errorHandle(t);this.$message({type:"error",message:e})},errorHandle:function(t){var e="无法完成指定的操作，无法提供信息";return t.message&&"string"==typeof t.message&&(e="",e=t.message),t.message&&"object"==n()(t.message)&&(e=this.errorHandleForEachObject(t.message)),t.errors&&"object"==n()(t.errors)&&(e=this.errorHandleForEachObject(t.errors)),e=e.substr(0,e.length-2)},errorHandleForEachObject:function(t){var e="";for(var a in t)e=e+t[a].join(",")+"☆";return e},success:function(t){this.$message({message:t,type:"success"})},pagination:function(t){this.current_page=t,this.fetchData()},sizeChange:function(t){this.pageSize=t,this.fetchData()},getRoleAll:function(){var t=this;Object(l.getRoles)().then(function(e){t.roles=e.data}).catch(function(t){})}},mounted:function(){},beforeCreate:function(){var t=this;Object(l.getRoles)().then(function(e){t.roles=e.data,t.fetchData()}).catch(function(t){})},filters:{roleFilter:function(t,e){return e.find(function(e){return e.name==t}).explain},avatarFilter:function(t){return r.a.site+"/"+t}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"admin"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{id:"toolbar",inline:!0,model:t.searchForm}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{placeholder:"用户姓名"},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"登录名"}},[a("el-input",{attrs:{placeholder:"系统登录名"},model:{value:t.searchForm.email,callback:function(e){t.$set(t.searchForm,"email",e)},expression:"searchForm.email"}})],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{plain:""},on:{click:function(e){t.find()}}},[t._v("查询")]),t._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:function(e){t.findReset()}}},[t._v("重置")])],1)],1),t._v(" "),a("div",{attrs:{id:"datagrid"}},[a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{plain:"",icon:"el-icon-plus"},on:{click:function(e){t.add()}}},[t._v("添加")]),t._v(" "),a("el-button",{attrs:{plain:"",icon:"el-icon-upload"},on:{click:function(e){t.upload()}}},[t._v("导入")]),t._v(" "),a("el-button",{attrs:{plain:"",icon:"el-icon-download"},on:{click:function(e){t.download()}}},[t._v("导出")])],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:!0}},[a("el-table-column",{attrs:{prop:"id",label:"序号",width:"70"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"email",label:"登录名"}}),t._v(" "),a("el-table-column",{staticClass:"box",attrs:{label:"角色"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.role,function(e){return a("el-tag",{key:e,staticStyle:{"margin-right":"5px"},attrs:{size:"medium"}},[t._v(t._s(t._f("roleFilter")(e,t.roles)))])})}}])}),t._v(" "),a("el-table-column",{attrs:{label:"头像",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.avatar?a("img",{attrs:{src:t._f("avatarFilter")(e.row.avatar),alt:"",width:"50",height:"50"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{content:"编辑",placement:"right-end"}},[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-edit-outline"},on:{click:function(a){t.edit(e.row)}}})],1),t._v(" "),a("el-tooltip",{attrs:{content:"修改密码",placement:"right-end"}},[a("el-button",{attrs:{plain:"",icon:"el-icon-setting",size:"small"},on:{click:function(a){t.reset(e.row)}}})],1),t._v(" "),a("el-tooltip",{attrs:{content:"删除",placement:"right-end"}},[a("el-button",{attrs:{plain:"",icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(a){t.del(e.row)}}})],1)]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"用户信息",visible:t.editDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editDialogFormVisible=e},close:function(e){return t.cancel(),!0}}},[a("el-form",{attrs:{model:t.form,"label-width":"80px","label-position":"top"}},[a("el-row",{staticClass:"first-row"},[a("el-col",{staticClass:"first-column",attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"登录名"}},[a("el-input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)],1)],1),t._v(" "),t.isNew?a("el-row",{staticClass:"normal-row"},[a("el-col",{staticClass:"first-column",attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})],1)],1)],1):t._e(),t._v(" "),a("el-row",{staticClass:"last-row",staticStyle:{height:"290px",overflow:"hidden"}},[a("el-col",{staticClass:"first-column",staticStyle:{height:"100%"},attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"用户头像"}},[a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{drag:"",action:"123",accept:".jpg,.png","before-upload":t.beforeUpload}},[t.form.avatar?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("上传头像，只能传jpg/png文件")])])],1)],1),t._v(" "),a("el-col",{staticStyle:{height:"100%"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"用户角色"}},[a("el-select",{attrs:{multiple:"",placeholder:"用户权限"},model:{value:t.form.role,callback:function(e){t.$set(t.form,"role",e)},expression:"form.role"}},t._l(t.roles,function(e){return a("el-option",{key:e.name,attrs:{label:e.explain,value:e.name}},[t._v("\n               "+t._s(e.explain))])}))],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.cancel()}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.save()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"密码重置",visible:t.resetDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.resetDialogFormVisible=e}}},[a("el-form",{attrs:{model:t.form2,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"请输入新密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form2.psw,callback:function(e){t.$set(t.form2,"psw",e)},expression:"form2.psw"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"再次确认密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form2.newpsw,callback:function(e){t.$set(t.form2,"newpsw",e)},expression:"form2.newpsw"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.cancelPassword()}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.savePassword()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-pagination",{attrs:{background:"","current-page":t.current_page,"page-sizes":[10,20,25,50],layout:"total,sizes,prev, pager, next","page-size":t.pageSize,total:t.total},on:{"current-change":t.pagination,"size-change":t.sizeChange,"update:currentPage":function(e){t.current_page=e},"update:pageSize":function(e){t.pageSize=e}}})],1),t._v(" "),a("upload-xls",{attrs:{show:t.isShowUpload,"template-file":t.templateFile,module:"admin"},on:{"close-upload":t.closeUpload}})],1)},staticRenderFns:[]};var d=a("VU/8")(s,c,!1,function(t){a("WXV/")},null,null);e.default=d.exports},jlWz:function(t,e,a){var o=a("wz4T");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("4afdaaf1",o,!0)},"kSC+":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n#toolbar {\n  background-color: #e8e8e8 !important;\n  margin-bottom: 5px;\n}\n#toolbar .el-form-item {\n    margin-bottom: 5px;\n    margin-top: 5px;\n    margin-left: 5px;\n}\n#datagrid {\n  border: 1px solid #ddd;\n  padding-bottom: 5px;\n}\n#datagrid .toolbar {\n    padding-left: 5px;\n    margin-bottom: 5px;\n    margin-top: 5px;\n}\n#datagrid .el-pagination {\n    padding: 0;\n    margin-top: 20px;\n    text-align: center;\n}\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #20a0ff;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n.el-pagination {\n  padding: 0;\n  margin-top: 20px;\n  text-align: right;\n}\n#admin .el-form--label-top .el-form-item__label {\n  width: 100%;\n  text-align: center;\n}\n#admin .el-form-item__content {\n  text-align: center;\n}\n#admin .el-col-10 > .el-form-item > .el-form-item__content > .el-input {\n  width: 80%;\n}\n#admin .first-row .el-col {\n  border: 1px solid black;\n  border-left: 0px;\n}\n#admin .first-row .first-column {\n  border-left: 1px solid black;\n}\n#admin .normal-row .el-col {\n  border: 1px solid black;\n  border-left: 0px;\n  border-top: 0px;\n}\n#admin .normal-row .first-column {\n  border-left: 1px solid black;\n}\n#admin .last-row .el-col {\n  border: 1px solid black;\n  border-top: 0px;\n  border-left: 0px;\n}\n#admin .last-row .first-column {\n  border-left: 1px solid black;\n}\n#admin .last-row .first-column .el-upload-dragger {\n  width: auto;\n  height: auto;\n}\n",""])},wz4T:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"",""])}});