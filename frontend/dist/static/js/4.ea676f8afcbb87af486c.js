webpackJsonp([4],{"1+b6":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("//Fk"),i=a.n(n),l=(a("TIfe"),a("Vo7i"));function o(e){return Object(l.a)({url:"/api/leader",method:"get",params:{page:e}})}var r=a("VPHD");a("/98u");function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.session_id=e,this.teacher_id=t,this.leader_type=a,this.job=n,this.remark=i}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.teacher_id=e,this.leader_type=t,this.session_id=a}var d={data:function(){return{formInline:new c,tableData:[],dialogFormVisible:!1,editDialogFormVisible:!1,paginationVisible:!0,resetId:"",uploadId:"",teachers:[],sessions:[],form:{id:"",session_id:0,teacher_id:0,leader_type:"",job:"",remark:""},session_id:null,isNew:!1,isEdit:!1,leaderType:["无","中层","学校"],newform:new s,current_page:1,leader_type_search:"",total:0,value8:"",teacherData:[],search_teacherID:""}},methods:{fetchData:function(){var e=this;o().then(function(t){var a=t.data;e.tableData=a,e.total=t.meta.total}).catch(function(){})},add:function(){this.editDialogFormVisible=!0,this.isNew=!0,this.form=new s},edit:function(e){var t=this,a=e.id;this.uploadId=a,(n=a,Object(l.a)({url:"/api/leader/"+n,method:"get"})).then(function(e){var a=e.data;t.form=a,t.isEdit=!0,t.editDialogFormVisible=!0});var n},saveData:function(){this.editDialogFormVisible=!1,this.isNew&&(this.isNew=!1,this.addLeaderData()),this.isEdit&&(this.isEdit=!1,this.updateLeaderData())},updateLeaderData:function(){var e=this;(t=this.uploadId,a=this.form,Object(l.a)({url:"/api/leader/"+t,method:"patch",data:{teacher_id:a.teacher_id,leader_type:a.leader_type,job:a.job,remark:a.remark}})).then(function(t){if(200==t.status_code){var a=e.form.id,n=0;n=e.tableData.findIndex(function(e,t){return e.id==a}),e.tableData.splice(n,1,e.form),e.$message({type:"success",message:"用户信息更新成功"})}}).catch(function(){console.log("连接失败")});var t,a},addLeaderData:function(){var e=this;(t=this.form,Object(l.a)({url:"/api/leader",method:"post",data:t})).then(function(t){e.$message({type:"success",message:"用户信息添加成功"})}).catch(function(e){console.log(e.response)});var t},search:function(){console.log(this.formInline)},searchReset:function(){this.formInline=new c("",null,this.session_id)},del:function(e){var t=this;this.$confirm("此操作将永久删除该信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=e.id,n=null;n=t.tableData.findIndex(function(e){return e.id==a}),(i=a,Object(l.a)({url:"/api/leader/"+i,method:"delete"})).then(function(e){200==e.status_code&&(t.$message({type:"success",message:"删除成功!"}),t.tableData.splice(n,1))}).catch(function(){console.log("删除失败")});var i}).catch(function(){})},handleCurrentChange:function(e){var t=this,a=e;this.current_page=a,o(a).then(function(e){var a=e.data;t.tableData=a})},handleCommand:function(e){var t=this;console.log(e);var a=e;this.leader_type_search=a,o(a).then(function(e){var a=e.data;t.tableData=a})},getSessions:function(){var e=this;return new i.a(function(t,a){Object(r.b)().then(function(a){e.sessions=a.data,t("sessions ok")}).catch(function(e){a("学期信息调用出错")})})},getTeachers:function(){var e=this;return new i.a(function(t,a){Object(r.c)().then(function(a){e.teachers=a.data,t("teachers ok")}).catch(function(e){a("教师信息调用出错")})})}},mounted:function(){var e=this;i.a.all([this.getSessions(),this.getTeachers()]).then(function(t){e.fetchData(),Object(r.a)().then(function(t){var a=t.data;e.session_id=a.id,e.formInline=new c("",null,e.session_id)})})},filters:{getTeacherName:function(e,t){return t.find(function(t){return t.id==e}).name},getLeaderType:function(e,t){return t[e]},adjustSessionMark:function(e,t){var a=t.year+1,n=1==t.team?"上学期":"下学期";return t.year+"-"+a+"学年"+n}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"leader"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{id:"toolbar",inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请查找或选择"},model:{value:e.formInline.teacher_id,callback:function(t){e.$set(e.formInline,"teacher_id",t)},expression:"formInline.teacher_id"}},e._l(e.teachers,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"行政类型"}},[a("el-select",{attrs:{clearable:"",placeholder:"行政类型"},model:{value:e.formInline.leader_type,callback:function(t){e.$set(e.formInline,"leader_type",t)},expression:"formInline.leader_type"}},[a("el-option",{attrs:{label:"中层领导",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"学校领导",value:"2"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"学期"}},[a("el-select",{attrs:{clearable:"",placeholder:"学期"},model:{value:e.formInline.session_id,callback:function(t){e.$set(e.formInline,"session_id",t)},expression:"formInline.session_id"}},e._l(e.sessions,function(t){return a("el-option",{key:t.id,attrs:{label:e._f("adjustSessionMark")(t.remark,t),value:t.id}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{plain:""},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.searchReset}},[e._v("重置")])],1)],1),e._v(" "),a("div",{attrs:{id:"datagrid"}},[a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{plain:"",icon:"el-icon-plus"},on:{click:function(t){e.add()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{plain:"",icon:"el-icon-download"},on:{click:function(t){e.add()}}},[e._v("导出")]),e._v(" "),a("el-button",{attrs:{plain:"",icon:"el-icon-upload"},on:{click:function(t){e.add()}}},[e._v("导入")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"序号",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{label:"教师",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("getTeacherName")(t.row.teacher_id,e.teachers)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"行政类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:1===t.row.leader_type?"primary":"success","close-transition":""}},[e._v(e._s(1==t.row.leader_type?"中层":"学校"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"job",label:"职务描述",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:"编辑",placement:"right-end",effect:"light"}},[a("el-button",{attrs:{plain:"",icon:"el-icon-edit",type:"primary",size:"small"},on:{click:function(a){e.edit(t.row)}}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"删除",placement:"right-end",effect:"light"}},[a("el-button",{attrs:{plain:"",icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(a){e.del(t.row)}}})],1)]}}])})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.paginationVisible,expression:"paginationVisible"}],attrs:{background:"","current-page":e.current_page,layout:"total, prev, pager, next","page-size":15,total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.current_page=t}}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"行政信息",center:"",visible:e.editDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editDialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"教师"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.teacher_id,callback:function(t){e.$set(e.form,"teacher_id",t)},expression:"form.teacher_id"}},e._l(e.teachers,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"行政类型",prop:"leader_type"}},[a("el-select",{attrs:{placeholder:"请选择行政类型"},model:{value:e.form.leader_type,callback:function(t){e.$set(e.form,"leader_type",t)},expression:"form.leader_type"}},[a("el-option",{attrs:{label:"中层",value:1}},[e._v("中层")]),e._v(" "),a("el-option",{attrs:{label:"学校",value:2}},[e._v("学校")])],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"职务描述",prop:"job"}},[a("el-input",{model:{value:e.form.job,callback:function(t){e.$set(e.form,"job",t)},expression:"form.job"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editDialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveData()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var f=a("VU/8")(d,u,!1,function(e){a("OG9Y")},null,null);t.default=f.exports},OG9Y:function(e,t,a){var n=a("c2ia");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("9b1fd2c6",n,!0)},VPHD:function(e,t,a){"use strict";t.b=function(){return Object(n.a)({url:"/api/getSession",method:"get"})},t.c=function(){return Object(n.a)({url:"/api/getTeacher",method:"get"})},t.a=function(){return Object(n.a)({url:"/api/getDefaultSession",method:"get"})};var n=a("Vo7i")},c2ia:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n#toolbar {\n  background-color: #e8e8e8 !important;\n  margin-bottom: 5px;\n}\n#toolbar .el-form-item {\n    margin-bottom: 5px;\n    margin-top: 5px;\n    margin-left: 5px;\n}\n#datagrid {\n  border: 1px solid #ddd;\n  padding-bottom: 5px;\n}\n#datagrid .toolbar {\n    padding-left: 5px;\n    margin-bottom: 5px;\n    margin-top: 5px;\n}\n#datagrid .el-pagination {\n    padding: 0;\n    margin-top: 20px;\n    text-align: center;\n}\n#leader .el-input {\n  width: 200px;\n  margin-left: 10px;\n}\n",""])}});