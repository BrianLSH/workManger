webpackJsonp([3],{"1+b6":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("//Fk"),i=a.n(o),n=a("pFYg"),r=a.n(n),l=a("Vo7i");function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.session_id=e,this.teacher_id=t,this.leader_type=a,this.job=o,this.remark=i}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.session_id=e,this.teacher_id=t,this.leader_type=a}var d=a("VPHD"),u=a("/98u"),p={data:function(){return{searchForm:new c,tableData:[],editDialogFormVisible:!1,uploadDialogFormVisible:!1,exportDialogFormVisible:!1,uploadId:"",teachers:[],sessions:[],form:new s,isNew:!1,isEdit:!1,leaderType:["无","中层","学校"],current_page:1,total:0,pageSize:10,session_id:null,xlsUrl:u.a.site+"/xls/leader.xls",exportXls:u.a.site+"/xls/行政管理.xls",exportType:2}},methods:{find:function(){this.fetchData()},findReset:function(){this.searchForm=new c(this.session_id,null,null),this.fetchData()},fetchData:function(){var e=this;(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(l.a)({url:"/api/leader",method:"get",params:{page:t,session_id:e.session_id,teacher_id:e.teacher_id,leader_type:e.leader_type}})})(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.searchForm,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.current_page).then(function(t){var a=t.data;0===t.meta.total?e.$alert("没有找到指定的内容","友情提示"):(e.tableData=a,e.total=t.meta.total,e.pageCount=t.meta.last_page)}).catch(function(t){e.error(t.response.data)})},add:function(){this.editDialogFormVisible=!0,this.isNew=!0,this.form=new s},edit:function(e){var t=this,a=e.id;this.uploadId=a,(o=a,Object(l.a)({url:"/api/leader/"+o,method:"get"})).then(function(e){var a=e.data;t.form=a,t.isEdit=!0,t.editDialogFormVisible=!0});var o},save:function(){this.editDialogFormVisible=!1,this.isNew&&(this.isNew=!1,this.newData()),this.isEdit&&(this.isEdit=!1,this.updateData())},updateData:function(){var e=this;(t=this.uploadId,a=this.form,Object(l.a)({url:"/api/leader/"+t,method:"patch",data:{teacher_id:a.teacher_id,leader_type:a.leader_type,job:a.job,remark:a.remark}})).then(function(t){if(200==t.status_code){var a=e.form.id,o=0;o=e.tableData.findIndex(function(e,t){return e.id==a}),e.tableData.splice(o,1,e.form),e.$message({type:"success",message:"用户信息更新成功"})}}).catch(function(t){e.error(t.response.data)});var t,a},newData:function(){var e=this;(t=this.form,Object(l.a)({url:"/api/leader",method:"post",data:t})).then(function(t){e.$message({type:"success",message:"用户信息添加成功"}),e.fetchData()}).catch(function(t){e.error(t.response.data)});var t},cancel:function(){this.editDialogFormVisible=!1,this.isNew=!1,this.isEdit=!1},download:function(){this.exportDialogFormVisible=!0},exportData:function(){var e=this;switch(this.exportType){case 1:(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(l.a)({url:"/api/leader/export",method:"get",params:{page:t,pageSize:e,session_id:a.session_id,teacher_id:a.teacher_id,leader_type:a.leader_type}})})(this.pageSize,this.current_page,this.searchForm).then(function(t){location.href=e.exportXls}).catch(function(t){e.error(t.response.data)});break;case 2:(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(l.a)({url:"/api/leader/exportAll",method:"get",params:{page:t,pageSize:e,session_id:a.session_id,teacher_id:a.teacher_id,leader_type:a.leader_type}})})(null,1,this.searchForm).then(function(t){location.href=e.exportXls}).catch(function(t){e.error(t.response.data)})}},upload:function(){this.uploadDialogFormVisible=!0},cancelUpload:function(){this.uploadDialogFormVisible=!1},saveUpload:function(){this.uploadDialogFormVisible=!1,this.fetchData()},downloadTemplate:function(){location.href=this.xlsUrl},beforeUpload:function(e){var t=this;if("application/vnd.ms-excel"!==e.type)return this.$message({type:"error",message:"文件格式不正确，无法上传"}),!1;var a=new FormData;a.append("file",e),(o=a,Object(l.a)({url:"/api/leader/upload",method:"post",data:o,headers:{"Content-Type":"multipart/form-data"}})).then(function(e){t.$message({message:"文件信息上传成功",type:"success"}),t.fetchData()});var o;return!0},submitUpload:function(){var e=this;this.$confirm("上传的信息将覆盖本学期的相关数据，是否上传","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$refs.upload.submit()}).catch(function(){console.log("上传操作取消")})},error:function(e){var t=this.errorHandle(e);this.$message({type:"error",message:t})},errorHandle:function(e){var t="无法完成指定的操作，无法提供信息";return e.message&&"string"==typeof e.message&&(t="",t=e.message),e.message&&"object"==r()(e.message)&&(t=this.errorHandleForEachObject(e.message)),e.errors&&"object"==r()(e.errors)&&(t=this.errorHandleForEachObject(e.errors)),t=t.substr(0,t.length-2)},errorHandleForEachObject:function(e){var t="";for(var a in e)t=t+e[a].join(",")+"☆";return t},del:function(e){var t=this;this.$confirm("此操作将永久删除该信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=e.id,o=null;o=t.tableData.findIndex(function(e){return e.id==a}),(i=a,Object(l.a)({url:"/api/leader/"+i,method:"delete"})).then(function(e){200==e.status_code&&(t.$message({type:"success",message:"删除成功!"}),t.tableData.splice(o,1))}).catch(function(e){t.error(e.response.data)});var i})},pagination:function(e){this.current_page=e,this.fetchData()},getSessions:function(){var e=this;return new i.a(function(t,a){Object(d.b)().then(function(a){e.sessions=a.data,t("sessions ok")}).catch(function(e){a("学期信息调用出错")})})},getTeachers:function(){var e=this;return new i.a(function(t,a){Object(d.c)().then(function(a){e.teachers=a.data,t("teachers ok")}).catch(function(e){a("教师信息调用出错")})})}},mounted:function(){console.log(document.querySelector(".el-dialog__body"))},created:function(){var e=this;i.a.all([this.getSessions(),this.getTeachers()]).then(function(t){e.fetchData(),Object(d.a)().then(function(t){var a=t.data;e.session_id=a.id,e.searchForm=new c(e.session_id,null,null)})})},watch:{},filters:{getTeacherName:function(e,t){return t.find(function(t){return t.id==e}).name},getLeaderType:function(e,t){return t[e]},adjustSessionMark:function(e,t){var a=t.year+1,o=1==t.team?"上学期":"下学期";return t.year+"-"+a+"学年"+o}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"leader"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{id:"toolbar",inline:!0,model:e.searchForm}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请查找或选择"},model:{value:e.searchForm.teacher_id,callback:function(t){e.$set(e.searchForm,"teacher_id",t)},expression:"searchForm.teacher_id"}},e._l(e.teachers,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"行政类型"}},[a("el-select",{attrs:{clearable:"",placeholder:"行政类型"},model:{value:e.searchForm.leader_type,callback:function(t){e.$set(e.searchForm,"leader_type",t)},expression:" searchForm.leader_type"}},[a("el-option",{attrs:{label:"中层领导",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"学校领导",value:"2"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"学期"}},[a("el-select",{attrs:{clearable:"",placeholder:"学期"},model:{value:e.searchForm.session_id,callback:function(t){e.$set(e.searchForm,"session_id",t)},expression:"searchForm.session_id"}},e._l(e.sessions,function(t){return a("el-option",{key:t.id,attrs:{label:e._f("adjustSessionMark")(t.remark,t),value:t.id}})}))],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{plain:""},on:{click:function(t){e.find()}}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){e.findReset()}}},[e._v("重置")])],1)],1),e._v(" "),a("div",{attrs:{id:"datagrid"}},[a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{plain:"",icon:"el-icon-plus"},on:{click:function(t){e.add()}}},[e._v("添加")]),e._v(" "),a("el-button",{attrs:{plain:"",icon:"el-icon-download"},on:{click:function(t){e.download()}}},[e._v("导出")]),e._v(" "),a("el-button",{attrs:{plain:"",icon:"el-icon-upload"},on:{click:function(t){e.upload()}}},[e._v("导入")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"序号",width:"70"}}),e._v(" "),a("el-table-column",{attrs:{label:"教师",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("getTeacherName")(t.row.teacher_id,e.teachers)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"行政类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:1===t.row.leader_type?"primary":"success","close-transition":""}},[e._v(e._s(e._f("getLeaderType")(t.row.leader_type,e.leaderType)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"job",label:"职务描述",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:"编辑",placement:"right-end",effect:"light"}},[a("el-button",{attrs:{plain:"",icon:"el-icon-edit",type:"primary",size:"small"},on:{click:function(a){e.edit(t.row)}}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"删除",placement:"right-end",effect:"light"}},[a("el-button",{attrs:{plain:"",icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(a){e.del(t.row)}}})],1)]}}])})],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.current_page,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.pagination,"update:currentPage":function(t){e.current_page=t}}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"行政信息",center:"",visible:e.editDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editDialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{ref:"tip",attrs:{label:"(*)教师"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择或者输入姓名"},model:{value:e.form.teacher_id,callback:function(t){e.$set(e.form,"teacher_id",t)},expression:"form.teacher_id"}},e._l(e.teachers,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"(*)行政类型",prop:"leader_type"}},[a("el-select",{attrs:{placeholder:"请选择行政类型"},model:{value:e.form.leader_type,callback:function(t){e.$set(e.form,"leader_type",t)},expression:"form.leader_type"}},[a("el-option",{attrs:{label:"中层",value:1}},[e._v("中层")]),e._v(" "),a("el-option",{attrs:{label:"学校",value:2}},[e._v("学校")])],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"职务描述",prop:"job"}},[a("el-input",{model:{value:e.form.job,callback:function(t){e.$set(e.form,"job",t)},expression:"form.job"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancel()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.save()}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"文件导入",center:"",visible:e.uploadDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.uploadDialogFormVisible=t}}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(t){e.downloadTemplate()}}},[e._v("下载模板")])],1),e._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"123","auto-upload":!1,"before-upload":e.beforeUpload,accept:".xls"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:function(t){e.submitUpload()}}},[e._v("上传到服务器")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("文件上传只接受xls文件")])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancelUpload()}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveUpload()}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"数据导出",visible:e.exportDialogFormVisible,size:"tiny","close-on-click-modal":!1},on:{"update:visible":function(t){e.exportDialogFormVisible=t}}},[a("div",[a("p",[e._v("请选择导出的数据范围")])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.exportType=1,e.exportData()}}},[e._v("当前页")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.exportType=2,e.exportData()}}},[e._v("全部")])],1)])],1)},staticRenderFns:[]};var h=a("VU/8")(p,f,!1,function(e){a("wgsQ")},null,null);t.default=h.exports},Lcdv:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n#toolbar {\n  background-color: #e8e8e8 !important;\n  margin-bottom: 5px;\n}\n#toolbar .el-form-item {\n    margin-bottom: 5px;\n    margin-top: 5px;\n    margin-left: 5px;\n}\n#datagrid {\n  border: 1px solid #ddd;\n  padding-bottom: 5px;\n}\n#datagrid .toolbar {\n    padding-left: 5px;\n    margin-bottom: 5px;\n    margin-top: 5px;\n}\n#datagrid .el-pagination {\n    padding: 0;\n    margin-top: 20px;\n    text-align: center;\n}\n#leader .el-input {\n  width: 200px;\n  margin-left: 10px;\n}\n",""])},VPHD:function(e,t,a){"use strict";t.b=function(){return Object(o.a)({url:"/api/getSession",method:"get"})},t.c=function(){return Object(o.a)({url:"/api/getTeacher",method:"get"})},t.a=function(){return Object(o.a)({url:"/api/getDefaultSession",method:"get"})};var o=a("Vo7i")},wgsQ:function(e,t,a){var o=a("Lcdv");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("b42b790a",o,!0)}});